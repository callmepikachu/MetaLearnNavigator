# MetaLearnNavigator
元认知学习导航器, 陌生领域中的引导式任务拆解与认知图谱辅助系统

## 系统交互设计

### 1. 问题输入节点
**交互设计：**
- 页面提供一个简单的文本输入框
- 用户输入想要学习的问题
- 输入完成后，页面分为两个区域：
  - 左侧：构建的认知地图（动态更新）
  - 右侧：系统学习流程图（显示当前进度）

**实现要点：**
- 简洁的用户界面，降低使用门槛
- 响应式布局，左右分屏显示
- 实时更新认知地图和流程状态

### 2. 任务拆解节点
**交互设计：**
- 系统调用API生成任务拆解参考方案
- API严格按照四种关系生成：上级、下级、并列、相关
- 用户可以调整拆解结果
- 关系类型限制：
  - 上级、下级、并列：只能选择，不能自定义
  - 相关：可以自定义关系名称
- 认知地图实时显示在页面左半边
- 提供"进入下一步: 任务重要性判断"按钮

**实现要点：**
- 集成外部API获取知识结构参考
- 可视化认知地图，支持节点和关系的交互编辑
- 关系类型的约束和验证
- 实时同步用户修改到认知地图显示

### 3. 任务重要性判断节点
**交互设计：**
- 用户在左侧认知地图上选择最重要的连线
- 页面提示："选择重要的，而不是简单的"
- 用户通过点击选择相邻的节点，只能选择一条连线
- 左下角弹出窗口显示选择出来的子任务1、2、3
- 提供确认按钮进入下一步

**实现要点：**
- 认知地图支持连线的交互选择
- 连线选择的视觉反馈（高亮、颜色变化等）
- 左下角子任务显示窗口
- 选择验证（确保只选择一条连线）

### 4. 子任务处理与记忆检索节点
**交互设计：**
- 左下角弹出框显示子任务序列
- 格式：(当前状态) -> (子任务1) -> (子任务2) -> (目标任务)
- 系统根据关键词搜索用户的知识卡片库
- 展示相关的历史知识卡片供用户参考
- 用户根据检索结果做出判断：
  - 找到相关知识 → 选择"JOL(学习判断)"按钮
  - 未找到相关知识 → 选择"FOK(知晓感判断)"按钮

**实现要点：**
- 子任务流程的可视化展示
- 知识卡片的存储和检索系统
- 关键词提取和匹配算法
- JOL/FOK分支的用户选择界面

### 5. 预期掌握程度设置节点
**交互设计：**
- 在任务拆解后，用户设置对目标任务和各子任务的预期掌握程度
- 掌握程度级别：
  - "语义级别的公式推导"
  - "建立表象的直觉理解"
- 为每个任务分别设置预期级别

**实现要点：**
- 任务列表的预期设置界面
- 掌握程度级别的选择组件
- 预期数据的存储和管理

### 6. JOL/FOK评估分支节点
**交互设计：**
- **JOL（学习判断）- "我能记住多少？"**
  - 完全记得住
  - 大部分记得住
  - 记不太住
  - 完全不记得

- **FOK（知晓感判断）- "我以后能搞懂多少？"**
  - 吃透
  - 能了解
  - 能了解一点点
  - 啃不下来

**实现要点：**
- 四选一的评估选项界面
- 选项到数值的映射系统
- 分支路径的导航逻辑

### 7. 预期对比判断节点
**交互设计：**
- 系统自动比较JOL/FOK评估结果与预期掌握程度
- 判断逻辑：JOL/FOK分数 >= 预期分数
- 结果展示：
  - 实际高于预期 → 显示"学习目标达成"，提供"结束学习"选项
  - 实际低于预期 → 自动进入EOL（难度判断）流程

**实现要点：**
- 评估分数与预期分数的比较算法
- 分数映射规则的定义
- 流程分支的自动导航
- 结果反馈的用户界面

### 8. EOL（难度判断）与信心评估节点
**交互设计：**
- 系统通过API搜索当前子任务的相关参考资料
- 向用户展示搜索到的学习资源和参考材料
- 用户根据资料情况和自身能力做出选择：
  - "有信心完成任务" → 进入学习时间分配
  - "没信心完成任务，但是有资料" → 寻求外部指导
  - "没信心完成任务，而且没资料" → 尝试任务切换

**实现要点：**
- 集成学习资源搜索API
- 参考资料的展示和筛选界面
- 三选一的信心评估选项
- 不同选择对应的流程分支导航

### 9. 学习时间分配节点（有信心完成任务）
**交互设计：**
- 用户选择学习时间：(20min) / (30min) / (1h) / (更长时间)
- 页面显示：
  - 当前学习问题
  - 倒计时器
  - 参考资料
- 学习过程中提供"学习进度受到阻碍了吗？"判断按钮
- 倒计时结束后，用户选择：
  - "受到阻碍了" → 返回EOL流程
  - "继续学习" → 进入下一轮学习

**实现要点：**
- 时间选择按钮组
- 倒计时功能
- 学习资料的展示
- 阻碍判断的交互逻辑

### 10. 寻求外部指导节点（没信心但有资料）
**交互设计：**
- 页面弹出提示："请寻求外部指导"
- 等待用户获得外部指导后
- 提供"学习时间分配"按钮，回到学习流程

**实现要点：**
- 简单的提示弹窗
- 流程暂停和恢复机制
- 返回学习时间分配的导航

### 11. 任务切换节点（没信心且没资料）
**交互设计：**
- 返回到认知地图页面
- 允许用户重新编辑认知地图
- 重新选择重要的连线
- 重新生成子任务
- 回到预期掌握程度设置节点

**实现要点：**
- 认知地图的重新编辑功能
- 连线重新选择的交互
- 子任务的重新生成
- 流程状态的重置和跳转

### 12. 学习策略选择/调整节点
**交互设计：**
- 系统提示用户："您现在处于学习策略选择/调整节点"
- 用户自主进行学习策略的思考和调整
- 提供"继续"按钮进入下一步

**实现要点：**
- 简单的节点状态提示
- 用户自主操作的等待机制

### 13. 学习进度阻碍判断节点
**交互设计：**
- 与第9节点中的阻碍判断相同
- 用户自主评估学习进度是否受阻
- 选择：
  - "受到阻碍" → 返回相应流程
  - "没有阻碍" → 进入回流监控

**实现要点：**
- 复用之前的阻碍判断逻辑
- 流程分支的导航

### 14. 回流监控节点
**交互设计：**
- 系统提示："您现在处于回流监控节点"
- 引导用户：
  - 回顾已学习到的知识
  - 与之前的认知地图进行对比
  - 发现更感兴趣的节点
- 提供"任务切换"按钮，允许用户修改认知地图

**实现要点：**
- 节点状态的明确提示
- 学习成果的回顾界面
- 返回认知地图编辑的导航

## 系统架构总结

### 核心功能模块
1. **认知地图构建与编辑**
   - 节点和连线的可视化
   - 关系类型的约束管理
   - 实时编辑和更新

2. **学习流程引擎**
   - 14个节点的流程控制
   - 分支逻辑的导航
   - 状态管理和数据持久化

3. **API集成模块**
   - 任务拆解参考API
   - 学习资源搜索API
   - 知识卡片检索系统

4. **用户交互界面**
   - 左右分屏布局
   - 动态弹窗和提示
   - 倒计时和进度跟踪

### 技术要求
- 前端：支持复杂图形交互的可视化框架
- 后端：流程引擎和API集成
- 数据存储：用户学习数据和知识卡片
- 实时更新：认知地图和流程状态的同步

## 技术栈

### 后端
- **Python 3.8+**
- **FastAPI** - 现代、快速的Web框架
- **SQLAlchemy** - ORM数据库操作
- **SQLite** - 轻量级数据库（开发环境）
- **Pydantic** - 数据验证和序列化
- **Uvicorn** - ASGI服务器

### 前端
- **React 18** - 用户界面框架
- **TypeScript** - 类型安全的JavaScript
- **Material-UI** - UI组件库
- **Redux Toolkit** - 状态管理
- **D3.js** - 数据可视化（认知地图）
- **Axios** - HTTP客户端

## 快速开始

### 环境要求
- Python 3.8 或更高版本
- Node.js 16 或更高版本
- Anaconda 或 Miniconda（推荐）

### 方法一：使用Conda环境（推荐）

#### Windows用户
```cmd
# 克隆项目
git clone <repository-url>
cd MetaLearnNavigator

# 运行Windows设置脚本
setup_windows.bat

# 激活环境
conda activate metalearn-navigator

# 启动服务
python start_dev.py
```

#### macOS/Linux用户
```bash
# 克隆项目
git clone <repository-url>
cd MetaLearnNavigator

# 创建并配置conda环境
python setup_conda_env.py

# 激活环境
conda activate metalearn-navigator

# 启动服务
python start_dev.py
```

### 方法二：直接启动
```bash
# 克隆项目
git clone <repository-url>
cd MetaLearnNavigator

# 运行启动脚本（自动安装依赖并启动服务）
python start_dev.py
```

启动脚本会自动：
1. 检查Python和Node.js环境
2. 安装后端和前端依赖
3. 创建环境配置文件
4. 启动后端API服务器（端口8000）
5. 启动前端开发服务器（端口3000）

### 方法三：手动启动

#### 使用Conda环境
```bash
# 创建conda环境
conda create -n metalearn-navigator python=3.9 nodejs=18 npm -y
conda activate metalearn-navigator

# 安装Python依赖
pip install -r requirements.txt

# 安装前端依赖
cd frontend && npm install && cd ..

# 启动后端服务
cd backend
uvicorn main:app --reload --host 0.0.0.0 --port 8000

# 启动前端服务（新终端）
cd frontend
npm start
```

#### 使用系统环境
```bash
# 安装Python依赖
pip install -r requirements.txt

# 进入后端目录
cd backend

# 复制环境配置文件
cp .env.example .env

# 启动后端服务
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

```bash
# 进入前端目录
cd frontend

# 安装依赖
npm install

# 启动开发服务器
npm start
```

### 访问应用
- **前端应用**: http://localhost:3000
- **后端API**: http://localhost:8000
- **API文档**: http://localhost:8000/docs
- **健康检查**: http://localhost:8000/health

## 项目结构
```
MetaLearnNavigator/
├── backend/                 # Python后端
│   ├── main.py             # FastAPI应用入口
│   ├── database/           # 数据库相关
│   │   ├── models.py       # SQLAlchemy模型
│   │   └── database.py     # 数据库连接配置
│   ├── models/             # Pydantic模型
│   │   └── schemas.py      # API数据模型
│   ├── routers/            # API路由
│   │   ├── learning_flow.py    # 学习流程API
│   │   ├── cognitive_map.py    # 认知地图API
│   │   ├── knowledge_cards.py  # 知识卡片API
│   │   └── api_integration.py  # 外部API集成
│   └── services/           # 业务逻辑服务
│       ├── flow_engine.py      # 学习流程引擎
│       └── keyword_extractor.py # 关键词提取
├── frontend/               # React前端
│   ├── src/
│   │   ├── components/     # React组件
│   │   ├── store/          # Redux状态管理
│   │   ├── services/       # API服务
│   │   └── App.tsx         # 应用入口
│   └── package.json
├── requirements.txt        # Python依赖
├── start_dev.py           # 开发环境启动脚本
├── test_backend.py        # 后端API测试脚本
└── README.md              # 项目文档
```

## 开发和测试

### 测试后端API
```bash
# 启动后端服务后，运行测试脚本
python test_backend.py
```

测试脚本会验证：
- 健康检查接口
- API文档访问
- 学习会话创建
- 任务拆解功能
- 知识卡片CRUD操作

### 开发调试
- **后端日志**: 后端服务会在控制台输出详细日志
- **API文档**: 访问 http://localhost:8000/docs 查看交互式API文档
- **数据库**: 开发环境使用SQLite，数据库文件位于 `backend/metalearn.db`
- **前端调试**: 使用浏览器开发者工具查看网络请求和状态

### 环境配置
复制 `backend/.env.example` 到 `backend/.env` 并根据需要修改：
```bash
# 数据库配置
DATABASE_URL=sqlite:///./metalearn.db
ASYNC_DATABASE_URL=sqlite+aiosqlite:///./metalearn.db

# OpenAI API密钥（可选，用于高级任务拆解）
OPENAI_API_KEY=your_openai_api_key_here

# 服务器配置
HOST=0.0.0.0
PORT=8000
DEBUG=True
```

## 功能特性

### 已实现功能
✅ **问题输入**: 用户输入学习问题
✅ **任务拆解**: AI辅助的认知地图生成
✅ **认知地图可视化**: D3.js实现的交互式图形界面
✅ **学习流程引擎**: 14个节点的完整学习流程
✅ **知识卡片系统**: 个人知识库管理
✅ **API集成**: 外部资源搜索和AI服务
✅ **数据持久化**: SQLite数据库存储

### 开发中功能
🚧 **完整的前端交互**: 所有14个学习节点的用户界面
🚧 **高级认知地图编辑**: 拖拽、缩放、节点编辑
🚧 **学习资源推荐**: 基于任务的资源搜索
🚧 **学习进度跟踪**: 时间管理和进度监控
🚧 **用户认证**: 多用户支持和数据隔离

## 贡献指南

1. Fork 项目
2. 创建功能分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 打开 Pull Request

## 许可证

本项目采用 MIT 许可证 - 查看 [LICENSE](LICENSE) 文件了解详情

## 联系方式

如有问题或建议，请通过以下方式联系：
- 提交 Issue
- 发送邮件
- 参与讨论
